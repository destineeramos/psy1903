---
title: "Processing Individual Participant"
author: "Destinee Ramos"
format: html
execute:
  echo: true
  warning: true
  message: false
---

This report documents how we import and process each participantâ€™s raw data file, summarize it using our functions, and combine the results into a single study-level dataset.

```{r}
if(!require("pacman")) {install.packages("pacman"); require("pacman")}
p_load("jsonlite", "ggplot2", "here")
#install.packages("jsonlite")   # only run once
#library(jsonlite)   
```

```{r}
source("../scripts/score_questionnaire.R")
source("../scripts/summarize_behavior.R")
source("../scripts/process_participant.R")


```


```{r}
file_list <- list.files(
  here::here("data", "raw"),
  pattern = "^npt-experiment-.*\\.csv$",
  full.names = FALSE
)
```


### 
```{r}

participant_rows <- lapply(file_list, process_participant)
# traceback()

```

### 
```{r}
study_level <- do.call(rbind, participant_rows)
```

```{r}
dir.create(".../data/cleaned", recursive = TRUE, showWarnings = FALSE)
write.csv(study_level, "../data/cleaned/study_level.csv", row.names = FALSE)
saveRDS(study_level, "../data/cleaned/study_level.rds")

```

### 
```{r}

stopifnot(nrow(study_level) == length(file_list))
head(study_level)
```
