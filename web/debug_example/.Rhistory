getwd()
set.seed(1903)
iat_data <- data.frame(
subject_id = 1:40,
rt = round(rnorm(40, mean = 520, sd = 120)),
congruent = sample(c(TRUE, FALSE), 40, replace = TRUE),
condition = sample(c("control", "incongruent"), 40, replace = TRUE)
)
# Randomly assign two NA values in the rt column
iat_data$rt[sample(1:nrow(iat_data), 2)] <- NA
# Save for later use
saveRDS(iat_data, file = "data/raw/iat_data.rds")
# Save for later use
saveRDS(iat_data, file = "../data/raw/iat_data.rds")
summary(iat_data_summary)
iat_data_summary <- summary(iat_data)
View(iat_data_summary)
mean(iat_data$rt)
mean(iat_data$rt, na.rm = TRUE)
str(iat_data)
calculate_group_means <- function(data) {
# BUG: using rt instead of data$rt
result <- tapply(rt, data$condition, mean, na.rm = TRUE)
return(result)
}
traceback()
calculate_group_means <- function(data) {
browser()  # Pause here to explore
result <- tapply(rt, data$condition, mean, na.rm = TRUE)
return(result)
}
calculate_group_means(iat_data)
ls()
data[1:5, "rt"]
rt
calculate_group_means <- function(data) {
browser()  # Pause here to explore
result <- tapply(data$rt, data$condition, mean, na.rm = TRUE)
return(result)
}
calculate_group_means(iat_data)
calculate_group_means <- function(data) {
#browser()  # Pause here to explore
result <- tapply(data$rt, data$condition, mean, na.rm = TRUE)
return(result)
}
calculate_group_means(iat_data)
system.time({
for (i in 1:nrow(iat_data)) {
if (is.na(iat_data[i, "rt"])) {
iat_data[i, "rt_category"] <- "Unknown"
} else if (iat_data[i, "rt"] < 500) {
iat_data[i, "rt_category"] <- "Fast"
} else {
iat_data[i, "rt_category"] <- "Slow"
}
}
})
system.time({
iat_data$rt_category <- ifelse(
is.na(iat_data$rt), "Unknown",
ifelse(iat_data$rt < 500, "Fast", "Slow")
)
})
setwd("~/Desktop/thesis_data")
data <- read.csv("thesis_data_114(2).csv")
data <- data[-c(1, 2), ]
colnames(data)
data_subset <- data[, c(
# ASRS
"ASRS_1", "ASRS_2", "ASRS_3", "ASRS_4", "ASRS_5", "ASRS_6", "ASRS_7",
# BSMAS
"BSMAS_1", "BSMAS_2", "BSMAS_3", "BSMAS_4", "BSMAS_5", "BSMAS_6",
# DASS (21 items)
"DASS_1", "DASS_2", "DASS_3", "DASS_4", "DASS_5", "DASS_6", "DASS_7",
"DASS_8", "DASS_9", "DASS_10", "DASS_11", "DASS_12", "DASS_13",
"DASS_14", "DASS_15", "DASS_16", "DASS_17", "DASS_18", "DASS_19",
"DASS_20", "DASS_21",
# SMUS (17 items)
"SMUS_1", "SMUS_2", "SMUS_3", "SMUS_4", "SMUS_5", "SMUS_6", "SMUS_7",
"SMUS_8", "SMUS_9", "SMUS_10", "SMUS_11", "SMUS_12", "SMUS_13",
"SMUS_14", "SMUS_15", "SMUS_16", "SMUS_17",
# ADHD info
"ADHD_Diagnosis", "ADHD_MedToday"
)]
data_subset <- data_subset[!is.na(data_subset$ADHD_MedToday) & data_subset$ADHD_MedToday != "", ]
nrow(data_subset)
data <- read.csv("thesis_data_115.csv")
data_subset <- data_subset[!is.na(data_subset$ADHD_MedToday) & data_subset$ADHD_MedToday != "", ]
nrow(data_subset)
data_subset <- data_subset[!is.na(data_subset$ADHD_MedToday), ]
nrow(data_subset)
data_subset_new <- data[, c(
# SMUS (17 items)
"SMUS_1", "SMUS_2", "SMUS_3", "SMUS_4", "SMUS_5", "SMUS_6", "SMUS_7",
"SMUS_8", "SMUS_9", "SMUS_10", "SMUS_11", "SMUS_12", "SMUS_13",
"SMUS_14", "SMUS_15", "SMUS_16", "SMUS_17",
# ADHD info
"ADHD_Diagnosis", "ADHD_MedToday"
)]
data_subset_new <- data_subset_new[!is.na(data_subset_new$ADHD_Diagnosis) & data_subset_new$ADHD_Diagnosis != "", ]
nrow(data_subset_new)
data <- read.csv("thesis_data_115.csv")
data <- data[-c(1, 2), ]
colnames(data)
data_ASRS_BSMAS <- data[, c("ResponseId",
"ASRS_1", "ASRS_2", "ASRS_3", "ASRS_4", "ASRS_5", "ASRS_6", "ASRS_7",
"BSMAS_1", "BSMAS_2", "BSMAS_3", "BSMAS_4", "BSMAS_5", "BSMAS_6","ADHD_Med")]
data_subset <- data[, c(
# ASRS
"ASRS_1", "ASRS_2", "ASRS_3", "ASRS_4", "ASRS_5", "ASRS_6", "ASRS_7",
# BSMAS
"BSMAS_1", "BSMAS_2", "BSMAS_3", "BSMAS_4", "BSMAS_5", "BSMAS_6",
# DASS (21 items)
"DASS_1", "DASS_2", "DASS_3", "DASS_4", "DASS_5", "DASS_6", "DASS_7",
"DASS_8", "DASS_9", "DASS_10", "DASS_11", "DASS_12", "DASS_13",
"DASS_14", "DASS_15", "DASS_16", "DASS_17", "DASS_18", "DASS_19",
"DASS_20", "DASS_21",
# SMUS (17 items)
"SMUS_1", "SMUS_2", "SMUS_3", "SMUS_4", "SMUS_5", "SMUS_6", "SMUS_7",
"SMUS_8", "SMUS_9", "SMUS_10", "SMUS_11", "SMUS_12", "SMUS_13",
"SMUS_14", "SMUS_15", "SMUS_16", "SMUS_17",
# ADHD info
"ADHD_Diagnosis", "ADHD_MedToday"
)]
data_subset <- data_subset[!is.na(data_subset$ADHD_MedToday) & data_subset$ADHD_MedToday != "", ]
data_subset <- data_subset[!is.na(data_subset$ADHD_MedToday), ]
nrow(data_subset)
Thesis_1 <- read.csv("thesis_data_115.csv")
colnames(Thesis_1)
Thesis_1 %>% count(ADHD_Diagnosis)
Thesis_1  %>% count(ADHD_MedToday)
Thesis_1  %>% count(ASRS_1)
Thesis_1  %>% count(ASRS_2)
install.packages("lessR")
install.packages("tidyverse")
install.packages("emmeans")
install.packages("ggplot")
install.packages("ggplot2")
library(lessR)
library(dplyr)
library(tidyverse)
library(emmeans)
library(ggplot2)
View(Novel_Measure_of_Interpretation_and_Self_Schema_Activation_in_Social_Media_October_7_2025_18_56)
Thesis_1 <- read.csv("thesis_data_115.csv")
colnames(Thesis_1)
Thesis_1 %>% count(ADHD_Diagnosis)
Thesis_1  %>% count(ADHD_MedToday)
Thesis_1  %>% count(ASRS_1)
Thesis_1  %>% count(ASRS_2)
Thesis_1 %>% count(SMUS_16)
##ASRS Numerical Total
Thesis_1 <- Thesis_1 %>%
mutate(across(
ASRS_1:ASRS_7,  # replace with the actual range of your questions
~ recode(.x,
"Never" = 1,
"Rarely" = 2,
"Sometimes" = 3,
"Often" = 4,
"Very Often" = 5),
.names = "{.col}_num"  # creates Q1_num, Q2_num, etc.
))
Thesis_1 <- Thesis_1 %>%
mutate(
ASRS_total = rowSums(select(., ends_with("_num")), na.rm = TRUE)
)
Thesis_1 %>%
select(ASRS_1, ASRS_1_num,
ASRS_2, ASRS_2_num,
ASRS_3, ASRS_3_num,
ASRS_4, ASRS_4_num,
ASRS_5, ASRS_5_num,
ASRS_6, ASRS_6_num,
ASRS_7, ASRS_7_num,
ASRS_total) %>%
head()
Thesis_1 <- Thesis_1 %>%
mutate(across(
BSMAS_1:BSMAS_6,  # replace with the actual range of your questions
~ recode(.x,
"Very Rarely" = 1,
"Rarely" = 2,
"Sometimes" = 3,
"Often" = 4,
"Very Often" = 5),
.names = "{.col}_num"  # creates Q1_num, Q2_num, etc.
))
Thesis_1 <- Thesis_1 %>%
mutate(
BSMAS_total = rowSums(select(., ends_with("_num")), na.rm = TRUE)
)
Thesis_1 %>%
select(BSMAS_1, BSMAS_1_num,
BSMAS_2, BSMAS_2_num,
BSMAS_3, BSMAS_3_num,
BSMAS_4, BSMAS_4_num,
BSMAS_5, BSMAS_5_num,
BSMAS_6, BSMAS_6_num,
BSMAS_total) %>%
head()
Thesis_1 %>% count(BSMAS_total)
Thesis_1 %>% count(ASRS_total)
cor.test(Thesis_1$ASRS_total, Thesis_1$BSMAS_total, method = "pearson")
cor.test(Thesis_1$ASRS_total, Thesis_1$BSMAS_total, method = "pearson")
library(ggplot2)
ggplot(Thesis_1, aes(x = ASRS_total, y = BSMAS_total)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(title = "Correlation Between ASRS and BSMAS Scores",
x = "ASRS Total Score (ADHD symptoms)",
y = "BSMAS Total Score (Social Media Addiction)") +
theme_minimal()
Thesis_1 <- Thesis_1 %>%
mutate(
BSMAS_total = ifelse(
rowSums(!is.na(select(., ends_with("_num")))) == 0,
NA,
rowSums(select(., ends_with("_num")), na.rm = TRUE)
)
)
cor.test(Thesis_1$ASRS_total, Thesis_1$BSMAS_total, method = "pearson")
library(ggplot2)
ggplot(Thesis_1, aes(x = ASRS_total, y = BSMAS_total)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(title = "Correlation Between ASRS and BSMAS Scores",
x = "ASRS Total Score (ADHD symptoms)",
y = "BSMAS Total Score (Social Media Addiction)") +
theme_minimal()
Thesis_1 %>% count(BSMAS_total)
ggplot(Thesis_1 %>% filter(!is.na(BSMAS_total), !is.na(ASRS_total)),
aes(x = ASRS_total, y = BSMAS_total)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
title = "Correlation Between ASRS and BSMAS Scores",
x = "ASRS Total Score (ADHD symptoms)",
y = "BSMAS Total Score (Social Media Addiction)"
) +
theme_minimal()
ggplot(Thesis_1 %>% filter(!is.na(BSMAS_total), !is.na(ASRS_total)),
aes(x = ASRS_total, y = BSMAS_total)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
title = "Correlation Between ASRS and BSMAS Scores",
x = "ASRS Total Score (ADHD symptoms)",
y = "BSMAS Total Score (Social Media Addiction)"
) +
theme_minimal()
Thesis_1 <- Thesis_1 %>%
mutate(
ASRS_total = as.numeric(ASRS_total),
BSMAS_total = as.numeric(BSMAS_total)
)
# --- STEP 2: Replace string "NA" or empty values with true NA ---
Thesis_1 <- Thesis_1 %>%
mutate(
BSMAS_total = na_if(BSMAS_total, "NA"),
BSMAS_total = na_if(BSMAS_total, ""),
ASRS_total = na_if(ASRS_total, "NA"),
ASRS_total = na_if(ASRS_total, "")
) %>%
mutate(across(c(BSMAS_total, ASRS_total), as.numeric))
Thesis_1 <- Thesis_1 %>%
mutate(
ASRS_total = suppressWarnings(as.numeric(ASRS_total)),
BSMAS_total = suppressWarnings(as.numeric(BSMAS_total))
)
# If either column is character, clean it
if (is.character(Thesis_1$BSMAS_total)) {
Thesis_1 <- Thesis_1 %>%
mutate(
BSMAS_total = na_if(BSMAS_total, "NA"),
BSMAS_total = na_if(BSMAS_total, "")
)
}
if (is.character(Thesis_1$ASRS_total)) {
Thesis_1 <- Thesis_1 %>%
mutate(
ASRS_total = na_if(ASRS_total, "NA"),
ASRS_total = na_if(ASRS_total, "")
)
}
# Convert again to numeric after cleaning
Thesis_1 <- Thesis_1 %>%
mutate(
ASRS_total = suppressWarnings(as.numeric(ASRS_total)),
BSMAS_total = suppressWarnings(as.numeric(BSMAS_total))
)
# --- STEP 3: Check for missing values ---
cat("Missing BSMAS_total:", sum(is.na(Thesis_1$BSMAS_total)), "\n")
cat("Missing ASRS_total:", sum(is.na(Thesis_1$ASRS_total)), "\n")
# --- STEP 4: Filter out missing totals for plotting ---
filtered_data <- Thesis_1 %>%
filter(!is.na(BSMAS_total), !is.na(ASRS_total))
cat("Rows kept for plotting:", nrow(filtered_data), "\n")
# --- STEP 5: Verify data summary ---
summary(filtered_data$BSMAS_total)
summary(filtered_data$ASRS_total)
# --- STEP 6: Create the scatterplot ---
ggplot(filtered_data, aes(x = ASRS_total, y = BSMAS_total)) +
geom_point(alpha = 0.6, color = "#2C3E50") +
geom_smooth(method = "lm", se = TRUE, color = "#1F77B4") +
labs(
title = "Correlation Between ASRS and BSMAS Scores",
x = "ASRS Total Score (ADHD symptoms)",
y = "BSMAS Total Score (Social Media Addiction)"
) +
theme_minimal(base_size = 14)
# --- STEP 7: Correlation and regression ---
cor.test(filtered_data$ASRS_total, filtered_data$BSMAS_total, method = "pearson")
model <- lm(BSMAS_total ~ ASRS_total, data = filtered_data)
summary(model)
summary(filtered_data$BSMAS_total)
filtered_data %>% filter(BSMAS_total == 0 | ASRS_total == 0)
Thesis_1 <- Thesis_1 %>%
mutate(
ASRS_total = ifelse(
rowSums(!is.na(select(., ASRS_1_num:ASRS_7_num))) == 0,
NA,
rowSums(select(., ASRS_1_num:ASRS_7_num), na.rm = TRUE)
)
)
# --- Fix BSMAS total (for consistency) ---
Thesis_1 <- Thesis_1 %>%
mutate(
BSMAS_total = ifelse(
rowSums(!is.na(select(., BSMAS_1_num:BSMAS_6_num))) == 0,
NA,
rowSums(select(., BSMAS_1_num:BSMAS_6_num), na.rm = TRUE)
)
)
# --- Filter only complete, valid rows for plotting ---
filtered_data <- Thesis_1 %>%
filter(!is.na(ASRS_total), !is.na(BSMAS_total))
# --- Check result ---
summary(filtered_data$ASRS_total)
summary(filtered_data$BSMAS_total)
# --- Plot again ---
library(ggplot2)
ggplot(filtered_data, aes(x = ASRS_total, y = BSMAS_total)) +
geom_point(alpha = 0.6, color = "#2C3E50") +
geom_smooth(method = "lm", se = TRUE, color = "#1F77B4") +
labs(
title = "Correlation Between ASRS and BSMAS Scores",
x = "ASRS Total Score (ADHD symptoms)",
y = "BSMAS Total Score (Social Media Addiction)"
) +
theme_minimal(base_size = 14)
